- ## Reproducibility in Machine Learning
	기계 학습 파이프라인을 구축하고 배포할 때 일반적으로 발생하는 문제와 기계 학습 파이프라인의 올바른 설계를 통해 이러한 문제를 최소화하는 방법에 대해 자세히 알려드리겠습니다.
	![[02_05_Challenges_to_reproducibility_2.png]]
	재현성은 비즈니스와 학계 모두에서 실제 문제이며, 재현성의 부재는 중요한 금전적 비용을 야기할 수 있습니다. 시간 손실과 평판 상실도 고려되어야 합니다. 따라서 이를 처음부터 올바르게 설정하는 것이 중요합니다.
	
	기계 학습에서 **재현성**이란 **동일한 모델을 복제할 수 있는 능력으로 정의**됩니다. 즉, 동일한 원시 데이터를 입력으로 받으면 두 모델이 동일한 출력을 반환해야 합니다. 우리는 기계 학습 알고리즘만 배포하는 것이 아니라 전체 기계 학습 파이프라인을 배포하므로 각 단계가 재현 가능한지 확인해야 합니다.
	![[02_05_Challenges_to_reproducibility_3.png]]
	기계 학습 파이프라인 단계를 간단히 되돌아보겠습니다. 데이터를 파이프라인에 주입하고 변수를 변환한 다음 특성을 선택하고 마지막으로 데이터를 모델에 전달합니다. 이제 어떤 단계에서 재현 가능성을 보장해야 할까요? 거의 모든 단계에서입니다. 모든 단계가 재현 가능하도록 해야 합니다.
	![[02_05_Challenges_to_reproducibility_4.png]]
	그림을 통해 어떤 단계에서 재현 가능성을 보장해야 하는지 확인할 수 있습니다. 각 단계가 동일한 데이터에서 동일한 결과를 생성하도록 보장해야 합니다. 연구 환경 및 프로덕션 및 배포된 모델에서 모두 동일한 결과를 만들어야 합니다.
	
	이제 기계 학습 파이프라인을 구축하고 배포할 때 발생하는 여러 문제와 이러한 문제를 최소화하기 위한 프레임워크를 소개하겠습니다.
	![[02_05_Challenges_to_reproducibility_5.png]]
	첫 번째로 데이터를 주입하고 사용하는 방식에 대해 논의하겠습니다. 이 단계는 재현성을 보장하기가 가장 어려운 도전입니다. 여기서의 문제는 훈련 세트를 나중에 재현할 수 없는 경우에 발생합니다. 예를 들어, 데이터베이스가 지속적으로 업데이트되고 재현성을 고려하지 않았다면 데이터베이스가 업데이트될 때 이전 레코드를 덮어쓸 수 있습니다. 또한 SQL을 사용할 때 데이터가 로드되는 순서에 따른 문제가 발생할 수 있습니다.
	
	이러한 문제를 최소화하려면 데이터를 모델을 훈련하는 데 사용한 스냅샷을 저장하고 나중에 사용할 수 있도록 합니다. 그러나 이 방법은 데이터를 다른 위치에 저장할 수 없는 경우나 데이터가 너무 많아 다른 위치에 저장할 수 없는 경우에는 유용하지 않을 수 있습니다. 또한 데이터 사용에 대한 새로운 규정이 있을 수 있어 소스 이외의 곳에 데이터를 저장하는 것이 허용되지 않을 수 있습니다.
	
	대안으로 데이터 소스를 정확한 타임스탬프와 함께 설계하여 언제든지 데이터의 뷰를 얻을 수 있도록 하는 것이 좋습니다. 그러나 비즈니스에서 이렇게 설계되지 않았다면 데이터 소스를 다시 설계하는 데 큰 노력이 필요할 수 있습니다. SQL이 행을 무작위로 로드하기 때문에 데이터를 로드할 때 어떤 변수를 사용하여 파일이 프로덕션 및 연구 환경에서 동일한 순서로 로드되도록하는 등의 방법을 사용할 수 있습니다.
	![[02_05_Challenges_to_reproducibility_6.png]]
	다음으로 특성 생성 또는 피처 엔지니어링 중에 재현 가능성을 보장해야 합니다. 재현성 부재는 누락된 데이터를 무작위로 추출한 값으로 대체하거나 백분율 기반의 관찰에 따라 레이블을 제거할 때 발생할 수 있습니다. 또한 누락된 값 대체에 사용되는 평균과 같은 통계 값을 계산하거나 특성 추출을 위한 더 복잡한 방정식에서도 발생할 수 있습니다.
	
	재현성 부재를 최소화하려면 몇 가지 코딩 최상의 방법을 적용할 수 있습니다. 첫째, 피처가 생성된 방식에 대한 코드는 버전 제어에 따라 추적되어야 하며 자동으로 증가되거나 타임스탬프 해시된 버전으로 게시되어야 합니다. 두 번째, 피처 엔지니어링에 사용되는 데이터에 따라 생성된 매개변수 중 많은 것이 의존하기 때문에 이전 슬라이드에서 논의한대로 데이터가 재현 가능하도록 보장해야 합니다. 무작위 샘플 추출을 통한 대체를 피하고 재현 가능성을 보장하기 위해 항상 시드를 설정하는 것이 좋습니다.
	![[02_05_Challenges_to_reproducibility_7.png]]
	기계 학습 모델의 훈련 자체도 재현성에 대한 도전을 제기합니다. 많은 기계 학습 알고리즘은 훈련에 무작위 요소를 사용하기 때문입니다. 예를 들어, 의사 결정 트리를 기반으로 한 알고리즘은 데이터의 하위 집합을 무작위로 추출하고 특성의 하위 집합을 무작위로 추출합니다. 뉴럴 네트워크를 사용하는 경우 가중치를 초기화하는 방법도 무작위입니다.
	
	이러한 도전에 대처하기 위해 모델을 훈련하기 전에 사용한 피처의 순서를 기록하거나 저장해야 합니다. 또한 기계 학습 모델을 훈련하기 전에 적용한 피처 변환을 저장해야 합니다. 모델의 하이퍼 파라미터를 최적화한다면 해당 하이퍼 파라미터의 값을 저장해야 합니다. 모델이 훈련에 무작위성이 필요한 경우 재현성을 위해 시드를 설정해야 합니다. 마지막으로 최종 모델이 여러 모델의 앙상블인 경우(제 4절에서 더 많이 다룰 예정), 이 앙상블의 구조를 어떻게 저장할지 고려해야 합니다.
	![[02_05_Challenges_to_reproducibility_8.png]]
	마지막으로 모델을 프로덕션 환경에 통합하는 동안 재현 가능성에 대한 도전이 있습니다. 종종 모델을 훈련하는 데 사용한 피처가 라이브 환경에서 사용할 수 없는 경우가 많습니다. 또한 연구 환경과 프로덕션 환경에서 다른 프로그래밍 언어 및 소프트웨어가 사용되며 라이브 프로덕션 환경을 통해 얻은 인구가 모델을 훈련하는 데 사용한 인구와 일치하지 않을 수 있습니다.
	
	모델을 프로덕션 환경에 통합하는 동안 재현 가능성을 보장하려면 소프트웨어 버전이 연구 환경에서 사용한 것과 정확히 일치해야 하며 응용 프로그램 또는 모델 API는 버전별로 모든 써드 파티 라이브러리 종속성을 나열해야 합니다. 이상적으로는 가능한 한 많은 소프트웨어 사양을 추적하기 위해 컨테이너를 사용해야 합니다. 연구, 개발 및 기계 학습 모델을 동일한 언어로 배포하여 연구 환경에서 사용한 라이브러리를 프로덕션 환경으로 이동시킬 수 있도록 하는 것이 중요합니다.
	
	마지막으로 모델을 어떻게 다른 시스템과 통합할지 모델을 구축하기 전에 정확히 이해해야 합니다. 잘못된 통합은 데이터 과학자가 모델을 구축할 때 비즈니스 시스템이 모델을 어떻게 사용할지 완전히 이해하지 못하기 때문에 발생하는 경우가 많습니다. 또한 소프트웨어 개발자가 기계 학습 파이프라인을 통합하는 데 필요한 모든 복잡성을 완전히 이해하지 못할 수도 있습니다. 실제로는 모델을 배포하는 반복 주기를 몇 번 거치면서 두 그룹이 함께 작업하는 방법을 배우고 이러한 문제가 최소화됩니다.